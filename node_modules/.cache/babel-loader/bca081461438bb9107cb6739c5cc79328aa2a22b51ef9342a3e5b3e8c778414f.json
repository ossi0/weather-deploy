{"ast":null,"code":"import React,{Component}from\"react\";import{returnStations,showData,showSnow}from\"../index\";import Metolib from\"@fmidev/metolib\";class Searchbar extends Component{constructor(props){super(props);this.handleDropdownVisibility=state=>{this.setState({visible:state===0?false:true});};this.handleDropdownSearch=event=>{this.setState({value:event.target.value});};// Tekee datapyynnön fmi:ltä ja kutsuu datankäsittelijäfunktion showData (index.js)\nthis.handleOptionClick=(id,option)=>{console.log(option);// Määritellään ensiksi tämänhetkinen aika (dt) sekä aika vuosi sitten (dtstart)\nvar dt=new Date();var dtstart=new Date(new Date().getFullYear()-1,new Date().getMonth(),new Date().getDate());var dtsnowstart=new Date(new Date().getFullYear(),new Date().getMonth(),new Date().getDate()-30);var parser=new Metolib.WfsRequestParser();var SERVER_URL=\"http://opendata.fmi.fi/wfs\";var STORED_QUERY_OBSERVATION=\"fmi::observations::weather::daily::multipointcoverage\";if(option===1){parser.getData({url:SERVER_URL,storedQueryId:STORED_QUERY_OBSERVATION,requestParameter:\"tmin,tmax\",begin:new Date(dtstart).getTime(),end:new Date(dt).getTime(),fmisid:id,callback:function(data,errors){console.log(data);showData(data);if(errors){// Miten tämä toimii??\nconsole.log(\"Virhe\");}}});}if(option===4){console.log(\"lumensyvyyden kuvaaja\");parser.getData({url:SERVER_URL,storedQueryId:STORED_QUERY_OBSERVATION,requestParameter:\"snow\",begin:new Date(dtsnowstart).getTime(),end:new Date(dt).getTime(),fmisid:id,callback:function(data,errors){console.log(data.locations[0].data.snow.timeValuePairs.length);if(data.locations.length>0){showSnow(data);}else{alert(\"Asemalta ei saatu tietoja. Kokeile toista asemaa\");}}});}};this.state={visible:false,value:\"\"};this.handleDropdownSearch=this.handleDropdownSearch.bind(this);}render(){const option=(name,key)=>/*#__PURE__*/React.createElement(\"a\",{style:{cursor:\"pointer\"},// href: key,\nkey:key,onMouseDown:()=>{// 4 = lumensyvyys, 1 = lämpötilakuvaaja\nif(window.location.pathname===\"/lumensyvyys\"){this.handleOptionClick(key,4);}if(window.location.pathname===\"/kuvaaja\"||\"/\"){this.handleOptionClick(key,1);}}},name);const fetchOptions=()=>{var optionlist=[];returnStations(this.state.value).forEach((value,index)=>{optionlist.push(option(value[0],value[1]));});return optionlist;};const dropdownVisibleClass=\"dropdown-content\";const dropdownHiddenClass=\"dropdown-content hidden\";return/*#__PURE__*/React.createElement(\"div\",{id:\"search\",className:\"card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-header justify-content-center \"},\"Valitse haluamasi mittausasema havaintohistoriaa varten\"),/*#__PURE__*/React.createElement(\"div\",{className:\"card-body justify-content-center\",onFocus:()=>this.handleDropdownVisibility(1),onBlur:()=>this.handleDropdownVisibility(0)},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",value:this.state.value,placeholder:\"Hae...\",id:\"dropdowninput\",onChange:this.handleDropdownSearch}),/*#__PURE__*/React.createElement(\"div\",{className:\"dropdown\"},/*#__PURE__*/React.createElement(\"div\",{id:\"dropdownbox\",className:this.state.visible===true?dropdownVisibleClass:dropdownHiddenClass},fetchOptions()))));}}export default Searchbar;","map":{"version":3,"names":["React","Component","returnStations","showData","showSnow","Metolib","Searchbar","constructor","props","handleDropdownVisibility","state","setState","visible","handleDropdownSearch","event","value","target","handleOptionClick","id","option","console","log","dt","Date","dtstart","getFullYear","getMonth","getDate","dtsnowstart","parser","WfsRequestParser","SERVER_URL","STORED_QUERY_OBSERVATION","getData","url","storedQueryId","requestParameter","begin","getTime","end","fmisid","callback","data","errors","locations","snow","timeValuePairs","length","alert","bind","render","name","key","createElement","style","cursor","onMouseDown","window","location","pathname","fetchOptions","optionlist","forEach","index","push","dropdownVisibleClass","dropdownHiddenClass","className","onFocus","onBlur","type","placeholder","onChange"],"sources":["C:/Users/Ossi Laurila/Desktop/weatherapp/src/components/searchbar.jsx"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport { returnStations, showData, showSnow } from \"../index\";\r\nimport Metolib from \"@fmidev/metolib\";\r\n\r\nclass Searchbar extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      visible: false,\r\n      value: \"\",\r\n    };\r\n\r\n    this.handleDropdownSearch = this.handleDropdownSearch.bind(this);\r\n  }\r\n\r\n  handleDropdownVisibility = (state) => {\r\n    this.setState({ visible: state === 0 ? false : true });\r\n  };\r\n  handleDropdownSearch = (event) => {\r\n    this.setState({ value: event.target.value });\r\n  };\r\n  // Tekee datapyynnön fmi:ltä ja kutsuu datankäsittelijäfunktion showData (index.js)\r\n  handleOptionClick = (id, option) => {\r\n    console.log(option);\r\n    // Määritellään ensiksi tämänhetkinen aika (dt) sekä aika vuosi sitten (dtstart)\r\n    var dt = new Date();\r\n    var dtstart = new Date(\r\n      new Date().getFullYear() - 1,\r\n      new Date().getMonth(),\r\n      new Date().getDate()\r\n    );\r\n    var dtsnowstart = new Date(\r\n      new Date().getFullYear(),\r\n      new Date().getMonth(),\r\n      new Date().getDate() - 30\r\n    );\r\n\r\n    var parser = new Metolib.WfsRequestParser();\r\n    var SERVER_URL = \"http://opendata.fmi.fi/wfs\";\r\n    var STORED_QUERY_OBSERVATION =\r\n      \"fmi::observations::weather::daily::multipointcoverage\";\r\n    if (option === 1) {\r\n      parser.getData({\r\n        url: SERVER_URL,\r\n        storedQueryId: STORED_QUERY_OBSERVATION,\r\n        requestParameter: \"tmin,tmax\",\r\n        begin: new Date(dtstart).getTime(),\r\n        end: new Date(dt).getTime(),\r\n        fmisid: id,\r\n        callback: function (data, errors) {\r\n          console.log(data);\r\n          showData(data);\r\n          if (errors) {\r\n            // Miten tämä toimii??\r\n            console.log(\"Virhe\");\r\n          }\r\n        },\r\n      });\r\n    }\r\n    if (option === 4) {\r\n      console.log(\"lumensyvyyden kuvaaja\");\r\n      parser.getData({\r\n        url: SERVER_URL,\r\n        storedQueryId: STORED_QUERY_OBSERVATION,\r\n        requestParameter: \"snow\",\r\n        begin: new Date(dtsnowstart).getTime(),\r\n        end: new Date(dt).getTime(),\r\n        fmisid: id,\r\n        callback: function (data, errors) {\r\n          console.log(data.locations[0].data.snow.timeValuePairs.length);\r\n          if (data.locations.length > 0) {\r\n            showSnow(data);\r\n          } else {\r\n            alert(\"Asemalta ei saatu tietoja. Kokeile toista asemaa\");\r\n          }\r\n\r\n        },\r\n      });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const option = (name, key) =>\r\n      React.createElement(\r\n        \"a\",\r\n        {\r\n          style: {\r\n            cursor: \"pointer\",\r\n          },\r\n          // href: key,\r\n          key: key,\r\n          onMouseDown: () => {\r\n            // 4 = lumensyvyys, 1 = lämpötilakuvaaja\r\n            if (window.location.pathname === \"/lumensyvyys\") {\r\n              this.handleOptionClick(key, 4);\r\n            }\r\n            if (window.location.pathname === \"/kuvaaja\" || \"/\") {\r\n              this.handleOptionClick(key, 1);\r\n            }\r\n          },\r\n        },\r\n        name\r\n      );\r\n    const fetchOptions = () => {\r\n      var optionlist = [];\r\n      returnStations(this.state.value).forEach((value, index) => {\r\n        optionlist.push(option(value[0], value[1]));\r\n      });\r\n      return optionlist;\r\n    };\r\n    const dropdownVisibleClass = \"dropdown-content\";\r\n    const dropdownHiddenClass = \"dropdown-content hidden\";\r\n    return (\r\n      <div id=\"search\" className=\"card\">\r\n        <div className=\"card-header justify-content-center \">\r\n          Valitse haluamasi mittausasema havaintohistoriaa varten\r\n        </div>\r\n        <div\r\n          className=\"card-body justify-content-center\"\r\n          onFocus={() => this.handleDropdownVisibility(1)}\r\n          onBlur={() => this.handleDropdownVisibility(0)}\r\n        >\r\n          <input\r\n            type=\"text\"\r\n            value={this.state.value}\r\n            placeholder=\"Hae...\"\r\n            id=\"dropdowninput\"\r\n            onChange={this.handleDropdownSearch}\r\n          />\r\n          <div className=\"dropdown\">\r\n            <div\r\n              id=\"dropdownbox\"\r\n              className={\r\n                this.state.visible === true\r\n                  ? dropdownVisibleClass\r\n                  : dropdownHiddenClass\r\n              }\r\n            >\r\n              {fetchOptions()}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Searchbar;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}